2025-11-23 22:45:10,145 - __main__ - INFO - ================================================================================
2025-11-23 22:45:10,145 - __main__ - INFO - STARTING INSULIN RESISTANCE PREDICTION PIPELINE
2025-11-23 22:45:10,145 - __main__ - INFO - ================================================================================
2025-11-23 22:45:10,146 - __main__ - INFO - 
[1/8] LOADING DATA...
2025-11-23 22:45:10,148 - __main__ - ERROR - ✗ Pipeline failed: Data file not found: /mnt/data/all_datasets_merged.csv
Traceback (most recent call last):
  File "C:\Users\rahul\Documents\code\projects\ir prediction\src\data_loader.py", line 41, in load_data
    df = pd.read_csv(data_path)
  File "C:\Users\rahul\Documents\code\projects\ir prediction\.venv\Lib\site-packages\pandas\io\parsers\readers.py", line 1026, in read_csv
    return _read(filepath_or_buffer, kwds)
  File "C:\Users\rahul\Documents\code\projects\ir prediction\.venv\Lib\site-packages\pandas\io\parsers\readers.py", line 620, in _read
    parser = TextFileReader(filepath_or_buffer, **kwds)
  File "C:\Users\rahul\Documents\code\projects\ir prediction\.venv\Lib\site-packages\pandas\io\parsers\readers.py", line 1620, in __init__
    self._engine = self._make_engine(f, self.engine)
                   ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^
  File "C:\Users\rahul\Documents\code\projects\ir prediction\.venv\Lib\site-packages\pandas\io\parsers\readers.py", line 1880, in _make_engine
    self.handles = get_handle(
                   ~~~~~~~~~~^
        f,
        ^^
    ...<6 lines>...
        storage_options=self.options.get("storage_options", None),
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\rahul\Documents\code\projects\ir prediction\.venv\Lib\site-packages\pandas\io\common.py", line 873, in get_handle
    handle = open(
        handle,
    ...<3 lines>...
        newline="",
    )
FileNotFoundError: [Errno 2] No such file or directory: '/mnt/data/all_datasets_merged.csv'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\rahul\Documents\code\projects\ir prediction\src\train.py", line 243, in <module>
    train_pipeline()
    ~~~~~~~~~~~~~~^^
  File "C:\Users\rahul\Documents\code\projects\ir prediction\src\train.py", line 96, in train_pipeline
    df = load_data(DATA_PATH)
  File "C:\Users\rahul\Documents\code\projects\ir prediction\src\data_loader.py", line 44, in load_data
    raise FileNotFoundError(f"Data file not found: {data_path}") from e
FileNotFoundError: Data file not found: /mnt/data/all_datasets_merged.csv
2025-11-23 22:45:30,604 - __main__ - INFO - ================================================================================
2025-11-23 22:45:30,604 - __main__ - INFO - STARTING INSULIN RESISTANCE PREDICTION PIPELINE
2025-11-23 22:45:30,605 - __main__ - INFO - ================================================================================
2025-11-23 22:45:30,605 - __main__ - INFO - 
[1/8] LOADING DATA...
2025-11-23 22:45:30,607 - __main__ - ERROR - ✗ Pipeline failed: Data file not found: /mnt/data/all_datasets_merged.csv
Traceback (most recent call last):
  File "C:\Users\rahul\Documents\code\projects\ir prediction\src\data_loader.py", line 41, in load_data
    df = pd.read_csv(data_path)
  File "C:\Users\rahul\Documents\code\projects\ir prediction\.venv\Lib\site-packages\pandas\io\parsers\readers.py", line 1026, in read_csv
    return _read(filepath_or_buffer, kwds)
  File "C:\Users\rahul\Documents\code\projects\ir prediction\.venv\Lib\site-packages\pandas\io\parsers\readers.py", line 620, in _read
    parser = TextFileReader(filepath_or_buffer, **kwds)
  File "C:\Users\rahul\Documents\code\projects\ir prediction\.venv\Lib\site-packages\pandas\io\parsers\readers.py", line 1620, in __init__
    self._engine = self._make_engine(f, self.engine)
                   ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^
  File "C:\Users\rahul\Documents\code\projects\ir prediction\.venv\Lib\site-packages\pandas\io\parsers\readers.py", line 1880, in _make_engine
    self.handles = get_handle(
                   ~~~~~~~~~~^
        f,
        ^^
    ...<6 lines>...
        storage_options=self.options.get("storage_options", None),
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\rahul\Documents\code\projects\ir prediction\.venv\Lib\site-packages\pandas\io\common.py", line 873, in get_handle
    handle = open(
        handle,
    ...<3 lines>...
        newline="",
    )
FileNotFoundError: [Errno 2] No such file or directory: '/mnt/data/all_datasets_merged.csv'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\rahul\Documents\code\projects\ir prediction\src\train.py", line 243, in <module>
    train_pipeline()
    ~~~~~~~~~~~~~~^^
  File "C:\Users\rahul\Documents\code\projects\ir prediction\src\train.py", line 96, in train_pipeline
    df = load_data(DATA_PATH)
  File "C:\Users\rahul\Documents\code\projects\ir prediction\src\data_loader.py", line 44, in load_data
    raise FileNotFoundError(f"Data file not found: {data_path}") from e
FileNotFoundError: Data file not found: /mnt/data/all_datasets_merged.csv
2025-11-23 22:45:48,388 - __main__ - INFO - ================================================================================
2025-11-23 22:45:48,388 - __main__ - INFO - STARTING INSULIN RESISTANCE PREDICTION PIPELINE
2025-11-23 22:45:48,389 - __main__ - INFO - ================================================================================
2025-11-23 22:45:48,389 - __main__ - INFO - 
[1/8] LOADING DATA...
2025-11-23 22:45:48,401 - __main__ - ERROR - ✗ Pipeline failed: Data file not found: C:\Users\rahul\Documents\code\projects\ir prediction\all_datasets_merged.csv
Traceback (most recent call last):
  File "C:\Users\rahul\Documents\code\projects\ir prediction\src\data_loader.py", line 41, in load_data
    df = pd.read_csv(data_path)
  File "C:\Users\rahul\Documents\code\projects\ir prediction\.venv\Lib\site-packages\pandas\io\parsers\readers.py", line 1026, in read_csv
    return _read(filepath_or_buffer, kwds)
  File "C:\Users\rahul\Documents\code\projects\ir prediction\.venv\Lib\site-packages\pandas\io\parsers\readers.py", line 620, in _read
    parser = TextFileReader(filepath_or_buffer, **kwds)
  File "C:\Users\rahul\Documents\code\projects\ir prediction\.venv\Lib\site-packages\pandas\io\parsers\readers.py", line 1620, in __init__
    self._engine = self._make_engine(f, self.engine)
                   ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^
  File "C:\Users\rahul\Documents\code\projects\ir prediction\.venv\Lib\site-packages\pandas\io\parsers\readers.py", line 1880, in _make_engine
    self.handles = get_handle(
                   ~~~~~~~~~~^
        f,
        ^^
    ...<6 lines>...
        storage_options=self.options.get("storage_options", None),
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\rahul\Documents\code\projects\ir prediction\.venv\Lib\site-packages\pandas\io\common.py", line 873, in get_handle
    handle = open(
        handle,
    ...<3 lines>...
        newline="",
    )
FileNotFoundError: [Errno 2] No such file or directory: 'C:\\Users\\rahul\\Documents\\code\\projects\\ir prediction\\all_datasets_merged.csv'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\rahul\Documents\code\projects\ir prediction\src\train.py", line 243, in <module>
    train_pipeline()
    ~~~~~~~~~~~~~~^^
  File "C:\Users\rahul\Documents\code\projects\ir prediction\src\train.py", line 96, in train_pipeline
    df = load_data(DATA_PATH)
  File "C:\Users\rahul\Documents\code\projects\ir prediction\src\data_loader.py", line 44, in load_data
    raise FileNotFoundError(f"Data file not found: {data_path}") from e
FileNotFoundError: Data file not found: C:\Users\rahul\Documents\code\projects\ir prediction\all_datasets_merged.csv
2025-11-23 22:46:00,951 - __main__ - INFO - ================================================================================
2025-11-23 22:46:00,951 - __main__ - INFO - STARTING INSULIN RESISTANCE PREDICTION PIPELINE
2025-11-23 22:46:00,951 - __main__ - INFO - ================================================================================
2025-11-23 22:46:00,951 - __main__ - INFO - 
[1/8] LOADING DATA...
2025-11-23 22:46:01,395 - __main__ - INFO - Loaded 7090 records with 63 columns
2025-11-23 22:46:01,395 - __main__ - INFO - 
[2/8] ENGINEERING FEATURES...
2025-11-23 22:46:01,415 - __main__ - INFO - Total features after engineering: 68
2025-11-23 22:46:01,415 - __main__ - INFO - 
[3/8] PREPROCESSING...
2025-11-23 22:46:03,614 - __main__ - INFO - Selected 46 features
2025-11-23 22:46:03,614 - __main__ - INFO - 
[4/8] SPLITTING DATA...
2025-11-23 22:46:03,642 - __main__ - INFO - Train: 4962, Val: 1064, Test: 1064
2025-11-23 22:46:03,642 - __main__ - INFO - 
[5/8] TRAINING BASE LEARNERS...
2025-11-23 22:46:03,643 - __main__ - INFO - Training XGBoost...
2025-11-23 22:46:04,594 - __main__ - INFO - ✓ XGBoost trained in 0.95s
2025-11-23 22:46:04,594 - __main__ - INFO - Training LightGBM...
2025-11-23 22:46:05,831 - __main__ - INFO - ✓ LightGBM trained in 1.24s
2025-11-23 22:46:05,831 - __main__ - INFO - Training CatBoost...
2025-11-23 22:46:09,924 - __main__ - INFO - ✓ CatBoost trained in 4.09s
2025-11-23 22:46:09,924 - __main__ - INFO - Training GradientBoosting...
2025-11-23 22:46:27,407 - __main__ - INFO - ✓ GradientBoosting trained in 17.48s
2025-11-23 22:46:27,407 - __main__ - INFO - ✓ All 4 base models trained
2025-11-23 22:46:27,451 - __main__ - INFO - xgboost - AUC: 1.0000, F1: 0.9994
2025-11-23 22:46:27,491 - __main__ - INFO - lightgbm - AUC: 1.0000, F1: 0.9994
2025-11-23 22:46:27,529 - __main__ - INFO - catboost - AUC: 1.0000, F1: 0.9994
2025-11-23 22:46:27,566 - __main__ - INFO - gradboost - AUC: 1.0000, F1: 1.0000
2025-11-23 22:46:27,600 - __main__ - INFO - Appended base model metrics to C:\Users\rahul\Documents\code\projects\ir prediction\models\base_models_metrics.csv
2025-11-23 22:46:27,601 - __main__ - INFO - 
[6/8] BUILDING STACKING ENSEMBLE...
2025-11-23 22:48:04,309 - __main__ - INFO - Stacking - AUC: 1.0000, F1: 0.9994
2025-11-23 22:48:04,309 - __main__ - INFO - 
[7/8] CALIBRATING ENSEMBLE...
2025-11-23 22:48:04,392 - __main__ - INFO - Calibration - Brier: 0.0002, ECE: 0.0022
2025-11-23 22:48:04,392 - __main__ - INFO - 
[8/8] OPTIMIZING THRESHOLDS...
2025-11-23 22:48:04,874 - __main__ - INFO - Saved optimal threshold: 0.0900
2025-11-23 22:48:04,995 - __main__ - INFO - Saved ensemble model to C:\Users\rahul\Documents\code\projects\ir prediction\models\ir_ensemble_best.pkl
2025-11-23 22:48:06,537 - __main__ - INFO - Saved ROC curve to C:\Users\rahul\Documents\code\projects\ir prediction\results\ensemble\roc_curve.png
2025-11-23 22:48:06,899 - __main__ - INFO - Saved PR curve to C:\Users\rahul\Documents\code\projects\ir prediction\results\ensemble\pr_curve.png
2025-11-23 22:48:06,901 - __main__ - INFO - 
================================================================================
2025-11-23 22:48:06,902 - __main__ - INFO - TRAINING COMPLETE in 125.95s
2025-11-23 22:48:06,902 - __main__ - INFO - ================================================================================

2025-11-23 22:48:06,908 - __main__ - INFO - ✓ Training pipeline completed successfully
2025-11-24 18:24:07,367 - __main__ - INFO - STARTING DATA AUDIT
2025-11-24 18:24:24,044 - __main__ - INFO - STARTING DATA AUDIT
2025-11-24 18:25:04,112 - __main__ - INFO - STARTING DATA AUDIT
2025-11-24 18:25:04,495 - __main__ - INFO - Loaded data shape: (57090, 62)
2025-11-24 18:25:04,537 - __main__ - INFO - Missing values:
pregnancies                50000
fasting_glucose            50000
blood_pressure             50000
skin_thickness             50000
fasting_insulin            50000
diabetes_pedigree          50000
gender                      7090
family_history              7090
stress_level               51000
outcome                    50000
alcohol                    51000
country                    51000
diabetesprevalence         51000
diabetes_risk_factor       51000
diet                       51000
dietscore                  51000
doctorspercapita           51000
economiclevel              51000
education                  51000
educationyears             51000
electricityaccess          51000
emergency_services         51000
exercisehours              51000
exercise_hours_week        51000
familyhistory              51000
hba1c                      51000
healthcenters              51000
health_literacy            51000
healthcareaccess           51000
healthcare_access          51000
healthcare_spend_usd       51000
incomelevel                51000
income_level               51000
insurance_coverage         51000
internetaccess             51000
lifestyle                  51000
medical_equipment_index    51000
mobilephone                51000
nutrition_quality          51000
patientid                  51000
population                 51000
prevention_access          51000
region                     51000
sdg10_index                51000
sdg3_index                 51000
sleepquality               51000
sleep_hours                51000
smoking                    51000
specialist_availability    51000
stresslevel                51000
urbanrural                 51000
source_dataset             51000
source_index               51000
patient_id                  7090
glucose_mg/dl               7090
bloodpressure_mmhg          7090
physical_activity_level     7090
diabetes_status             7090
dtype: int64
2025-11-24 18:25:04,579 - __main__ - INFO - Data shape after engineering: (57090, 66)
2025-11-24 18:25:04,581 - __main__ - INFO - Label distribution:
ir_label
0    0.900718
1    0.099282
Name: proportion, dtype: float64
2025-11-24 18:25:04,732 - __main__ - INFO - Top 10 Positive Correlations with ir_label:
2025-11-24 18:25:04,732 - __main__ - INFO - ir_label               1.000000
fasting_insulin_log    0.829453
fasting_insulin        0.434835
skin_thickness         0.200384
alcohol                0.177642
fasting_glucose_log    0.157576
smoking                0.140328
outcome                0.129534
fasting_glucose        0.123127
diabetes_pedigree      0.057950
dtype: float64
2025-11-24 18:25:04,734 - __main__ - INFO - Top 10 Negative Correlations with ir_label:
2025-11-24 18:25:04,734 - __main__ - INFO - stress_level         -0.010718
bmi                  -0.013145
age_bmi              -0.178635
pregnancies          -0.181088
age                  -0.187727
source_index         -0.391463
quicki               -0.881400
patient_id                 NaN
glucose_mg/dl              NaN
bloodpressure_mmhg         NaN
dtype: float64
2025-11-24 18:25:04,736 - __main__ - INFO - Running quick Random Forest for feature importance...
2025-11-24 18:25:52,917 - __main__ - INFO - STARTING DATA AUDIT
2025-11-24 18:25:53,266 - __main__ - INFO - Loaded data shape: (57090, 62)
2025-11-24 18:25:53,300 - __main__ - INFO - Missing values:
pregnancies                50000
fasting_glucose            50000
blood_pressure             50000
skin_thickness             50000
fasting_insulin            50000
diabetes_pedigree          50000
gender                      7090
family_history              7090
stress_level               51000
outcome                    50000
alcohol                    51000
country                    51000
diabetesprevalence         51000
diabetes_risk_factor       51000
diet                       51000
dietscore                  51000
doctorspercapita           51000
economiclevel              51000
education                  51000
educationyears             51000
electricityaccess          51000
emergency_services         51000
exercisehours              51000
exercise_hours_week        51000
familyhistory              51000
hba1c                      51000
healthcenters              51000
health_literacy            51000
healthcareaccess           51000
healthcare_access          51000
healthcare_spend_usd       51000
incomelevel                51000
income_level               51000
insurance_coverage         51000
internetaccess             51000
lifestyle                  51000
medical_equipment_index    51000
mobilephone                51000
nutrition_quality          51000
patientid                  51000
population                 51000
prevention_access          51000
region                     51000
sdg10_index                51000
sdg3_index                 51000
sleepquality               51000
sleep_hours                51000
smoking                    51000
specialist_availability    51000
stresslevel                51000
urbanrural                 51000
source_dataset             51000
source_index               51000
patient_id                  7090
glucose_mg/dl               7090
bloodpressure_mmhg          7090
physical_activity_level     7090
diabetes_status             7090
dtype: int64
2025-11-24 18:25:53,334 - __main__ - INFO - Data shape after engineering: (57090, 66)
2025-11-24 18:25:53,337 - __main__ - INFO - Label distribution:
ir_label
0    0.900718
1    0.099282
Name: proportion, dtype: float64
2025-11-24 18:25:53,392 - __main__ - INFO - Top 10 Positive Correlations with ir_label:
2025-11-24 18:25:53,392 - __main__ - INFO - ir_label               1.000000
fasting_insulin_log    0.829453
fasting_insulin        0.434835
skin_thickness         0.200384
alcohol                0.177642
fasting_glucose_log    0.157576
smoking                0.140328
outcome                0.129534
fasting_glucose        0.123127
diabetes_pedigree      0.057950
dtype: float64
2025-11-24 18:25:53,394 - __main__ - INFO - Top 10 Negative Correlations with ir_label:
2025-11-24 18:25:53,394 - __main__ - INFO - stress_level         -0.010718
bmi                  -0.013145
age_bmi              -0.178635
pregnancies          -0.181088
age                  -0.187727
source_index         -0.391463
quicki               -0.881400
patient_id                 NaN
glucose_mg/dl              NaN
bloodpressure_mmhg         NaN
dtype: float64
2025-11-24 18:25:53,396 - __main__ - INFO - Running quick Random Forest for feature importance...
2025-11-24 18:25:54,650 - __main__ - INFO - Quick RF AUC: 1.0000
2025-11-24 18:25:54,653 - __main__ - INFO - Top 10 Feature Importances:
2025-11-24 18:25:54,654 - __main__ - INFO - quicki                     0.200912
fasting_insulin_log        0.117814
medical_equipment_index    0.095204
economiclevel              0.076805
electricityaccess          0.064174
emergency_services         0.052612
population                 0.051392
fasting_insulin            0.042597
internetaccess             0.039085
diabetesprevalence         0.037938
dtype: float64
